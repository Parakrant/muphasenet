<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MuPhaseNet — Audio Examples</title>
<meta name="description" content="Audio examples for MuPhaseNet with Block A (noise+reverb) and Block B (effects-aware) systems."/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #2563eb;
    --primary-light: #3b82f6;
    --primary-dark: #1d4ed8;
    --secondary: #64748b;
    --accent: #06b6d4;
    --success: #10b981;
    --warning: #f59e0b;
    --error: #ef4444;
    --bg-primary: #ffffff;
    --bg-secondary: #f8fafc;
    --bg-tertiary: #f1f5f9;
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --text-muted: #64748b;
    --border-light: #e2e8f0;
    --border-medium: #cbd5e1;
    --border-dark: #94a3b8;
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --radius: 0.75rem;
    --radius-sm: 0.5rem;
    --radius-lg: 1rem;
  }

  * {
    box-sizing: border-box;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    color: var(--text-primary);
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    margin: 0;
    padding: 2rem;
    min-height: 100vh;
  }

  .container {
    max-width: 1600px;
    margin: 0 auto;
    background: var(--bg-primary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    padding: 3rem;
    border: 1px solid var(--border-light);
  }

  h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
  }

  h2 {
    font-size: 1.875rem;
    font-weight: 600;
    margin: 3rem 0 1rem;
    color: var(--text-primary);
    border-bottom: 2px solid var(--primary);
    padding-bottom: 0.5rem;
  }

  p {
    margin: 0 0 1rem;
    color: var(--text-secondary);
  }

  .intro {
    text-align: center;
    font-size: 1.125rem;
    color: var(--text-secondary);
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border-radius: var(--radius);
    border-left: 4px solid var(--primary);
  }

  .legend {
    font-size: 0.875rem;
    color: var(--text-muted);
    margin: 1rem 0 2rem;
    padding: 1rem;
    background: var(--bg-tertiary);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border-light);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    background: var(--bg-primary);
    border-radius: var(--radius);
    overflow-x: auto;
    box-shadow: var(--shadow-md);
    border: 1px solid var(--border-light);
    table-layout: auto;
  }

  .table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border-radius: var(--radius);
  }

  table th:first-child,
  table td:first-child {
    width: 80px;
    min-width: 80px;
    position: sticky;
    left: 0;
    background: inherit;
    z-index: 1;
  }

  table thead th:first-child {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  }

  table th:not(:first-child),
  table td:not(:first-child) {
    min-width: 200px;
    width: 200px;
  }

  thead {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  }

  thead th {
    text-align: left;
    font-weight: 600;
    font-size: 0.875rem;
    color: white;
    padding: 1rem 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
  }

  tbody tr {
    transition: background-color 0.2s ease;
    border-bottom: 1px solid var(--border-light);
  }

  tbody tr:hover {
    background: var(--bg-secondary);
  }

  tbody tr:last-child {
    border-bottom: none;
  }

  tbody td {
    padding: 1rem 0.75rem;
    vertical-align: middle;
    color: var(--text-primary);
  }

  .sys {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    align-items: center;
  }

  .group-tag {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    margin-right: 0.5rem;
    margin-top: 0.25rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .group-sep {
    width: 100%;
    height: 0;
    display: block;
    margin: 0.5rem 0;
    border-top: 1px dashed var(--border-medium);
  }

  .audio-cell {
    padding: 0.75rem 0.5rem;
    text-align: center;
    vertical-align: middle;
  }

  .cell-audio {
    width: 100%;
    max-width: 180px;
    min-width: 160px;
    height: 40px;
    border-radius: var(--radius-sm);
    filter: drop-shadow(0 1px 2px rgb(0 0 0 / 0.1));
  }

  audio {
    width: 280px;
    height: 40px;
    vertical-align: middle;
    border-radius: var(--radius-sm);
    filter: drop-shadow(0 2px 4px rgb(0 0 0 / 0.1));
  }

  .small {
    font-size: 0.875rem;
    color: var(--text-muted);
  }

  .rowhdr {
    white-space: nowrap;
    font-weight: 600;
    color: var(--text-primary);
  }

  .results {
    margin-top: 2rem;
    transform: scale(0.8);
    transform-origin: center top;
    margin-bottom: -20%;
  }

  .results table {
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    border: 1px solid var(--border-light);
  }

  .results thead {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  }

  .results thead th {
    text-align: center;
    font-weight: 600;
    font-size: 0.875rem;
    color: white;
    padding: 1rem 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    border-right: 1px solid rgba(255, 255, 255, 0.1);
  }

  .results thead th:last-child {
    border-right: none;
  }

  .results tbody tr {
    transition: background-color 0.2s ease;
    border-bottom: 1px solid var(--border-light);
  }

  .results tbody tr:hover {
    background: var(--bg-secondary);
  }

  .results tbody tr:last-child {
    border-bottom: none;
  }

  .results tbody td {
    padding: 0.875rem 0.75rem;
    text-align: center;
    vertical-align: middle;
    border-right: 1px solid var(--border-light);
  }

  .results tbody td:first-child {
    text-align: left;
    font-weight: 500;
    background: var(--bg-secondary);
  }

  .results tbody td:last-child {
    border-right: none;
  }

  .results caption {
    caption-side: top;
    text-align: left;
    font-weight: 600;
    color: var(--text-primary);
    padding: 0 0 1rem;
    font-size: 1rem;
  }

  .results tbody tr td:first-child {
    font-weight: 500;
  }

  .results tbody tr td strong {
    color: var(--primary);
    font-weight: 700;
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .results tbody tr:first-child td,
  .results tbody tr:nth-child(4) td,
  .results tbody tr:nth-child(9) td {
    background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
    font-style: italic;
    font-weight: 600;
    color: var(--text-secondary);
    text-align: center;
    border-bottom: 2px solid var(--border-medium);
  }

  .results tbody tr:first-child td:first-child,
  .results tbody tr:nth-child(4) td:first-child,
  .results tbody tr:nth-child(9) td:first-child {
    text-align: left;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
  }

  .hr {
    margin: 3rem 0;
    border: none;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border-medium), transparent);
  }

  footer {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border-light);
    text-align: center;
  }

  footer a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
  }

  footer a:hover {
    color: var(--primary-dark);
    text-decoration: underline;
  }

  .metric-desc {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: var(--radius);
    margin-bottom: 1.5rem;
    border-left: 4px solid var(--accent);
  }

  @media (max-width: 1400px) {
    .container {
      max-width: 95%;
      padding: 2rem;
    }
  }

  @media (max-width: 1024px) {
    .container {
      padding: 1.5rem;
      max-width: 100%;
    }
    
    h1 {
      font-size: 2rem;
    }
    
    h2 {
      font-size: 1.5rem;
    }

    table th:first-child,
    table td:first-child {
      width: 70px;
      min-width: 70px;
      font-size: 0.8rem;
    }

    table th:not(:first-child),
    table td:not(:first-child) {
      min-width: 180px;
      width: 180px;
    }

    .cell-audio {
      max-width: 160px;
      min-width: 140px;
      height: 36px;
    }

    thead th {
      font-size: 0.75rem;
      padding: 0.75rem 0.5rem;
    }
  }

  @media (max-width: 768px) {
    body {
      padding: 0.5rem;
    }
    
    .container {
      padding: 1rem;
      border-radius: var(--radius-sm);
    }
    
    h1 {
      font-size: 1.75rem;
    }

    .intro {
      padding: 1rem;
      font-size: 1rem;
    }

    table th:first-child,
    table td:first-child {
      width: 60px;
      min-width: 60px;
      font-size: 0.75rem;
    }

    table th:not(:first-child),
    table td:not(:first-child) {
      min-width: 160px;
      width: 160px;
    }

    .cell-audio {
      max-width: 140px;
      min-width: 120px;
      height: 32px;
    }

    thead th {
      font-size: 0.7rem;
      padding: 0.5rem 0.25rem;
      line-height: 1.2;
    }

    .audio-cell {
      padding: 0.5rem 0.25rem;
    }

    .results thead th {
      font-size: 0.75rem;
      padding: 0.75rem 0.5rem;
    }

    .results tbody td {
      padding: 0.75rem 0.5rem;
      font-size: 0.875rem;
    }

    .results {
      transform: scale(0.75);
      margin-bottom: -25%;
    }

    table {
      font-size: 0.875rem;
    }
  }

  @media (max-width: 480px) {
    body {
      padding: 0.25rem;
    }

    .container {
      padding: 0.75rem;
      border-radius: var(--radius-sm);
    }

    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .intro {
      padding: 0.75rem;
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    
    .legend {
      padding: 0.5rem;
      font-size: 0.75rem;
    }

    table th:first-child,
    table td:first-child {
      width: 50px;
      min-width: 50px;
      font-size: 0.7rem;
    }

    table th:not(:first-child),
    table td:not(:first-child) {
      min-width: 140px;
      width: 140px;
    }

    .cell-audio {
      max-width: 120px;
      min-width: 100px;
      height: 28px;
    }

    thead th {
      font-size: 0.65rem;
      padding: 0.375rem 0.125rem;
      line-height: 1.1;
    }

    .audio-cell {
      padding: 0.375rem 0.125rem;
    }

    table {
      font-size: 0.8rem;
    }

    .rowhdr {
      writing-mode: vertical-rl;
      text-orientation: mixed;
    }

    .results {
      overflow-x: auto;
      transform: scale(0.7);
      margin-bottom: -30%;
    }

    .results table {
      min-width: 600px;
    }

    .results thead th {
      font-size: 0.65rem;
      padding: 0.5rem 0.25rem;
    }

    .results tbody td {
      padding: 0.5rem 0.25rem;
      font-size: 0.75rem;
    }
  }
</style>
</head>
<body>
<div class="container">
  <h1>MuPhaseNet 🔧 - Audio Examples</h1>
  <!-- <p class="intro">
  Audio samples of MuPhaseNet’s <strong>music enhancement</strong>. Compare
  <em>Context</em> (NoEnh/Clean), <em>Block&nbsp;A</em> (noise+reverb baseline), and
  <em>Block&nbsp;B</em> (effects-aware) including waveform-conditioned modules (EE/ED).
  Click any system to A/B within a clip; players automatically stop others for focused listening.
</p> -->

  <!-- Audio demo table -->
  <p class="legend" id="legend">Loading…</p>
  <div class="table-wrapper">
    <table aria-label="audio examples">
      <thead id="thead">
        <!-- Will be generated by JavaScript -->
      </thead>
      <tbody id="tbody">
        <!-- Will be generated by JavaScript -->
      </tbody>
    </table>
  </div>

  <p class="small" id="footer">—</p>

  <hr class="hr"/>
<!-- 
  Commented out for now -->
  <h2>Table 1 - Objective Metrics and MOS</h2>
  <div class="metric-desc" id="metric-desc">
    <!-- Description will be generated by JavaScript -->
  </div>

  <table class="results" aria-label="results table">
    <thead>
      <tr>
        <th>System</th>
        <th>SDR&nbsp;↑</th>
        <th>fwSSNR&nbsp;↑</th>
        <th>L1&nbsp;↓</th>
        <th>MRS&nbsp;↓</th>
        <th>MOS (mean&nbsp;±&nbsp;CI)&nbsp;↑</th>
      </tr>
    </thead>
    <tbody>
      <tr><td colspan="6"><em>A) Trained with baseline noise+reverb simulator</em></td></tr>
      <tr>
        <td>Chae (ref.)</td>
        <td>4.66</td><td>12.68</td><td>1.25</td><td>0.81</td><td>3.25 ± 0.12</td>
      </tr>
      <tr>
        <td><strong>MPN (baseline)</strong></td>
        <td><strong>5.36</strong></td><td><strong>13.09</strong></td><td><strong>1.15</strong></td><td><strong>0.75</strong></td><td>3.40 ± 0.10</td>
      </tr>

      <tr><td colspan="6"><em>B) Trained with proposed effects-aware simulator</em></td></tr>
      <tr>
        <td>MPN</td>
        <td>4.01</td><td>12.34</td><td>1.29</td><td>0.87</td><td>3.20 ± 0.10</td>
      </tr>
      <tr>
        <td>MPN+EE</td>
        <td>4.19</td><td>12.36</td><td>1.32</td><td>0.88</td><td>3.40 ± 0.10</td>
      </tr>
      <tr>
        <td><strong>MPN+EE+ED-Mag</strong></td>
        <td><strong>4.40</strong></td><td>12.46</td><td>1.27</td><td><strong>0.85</strong></td><td>3.75 ± 0.09</td>
      </tr>
      <tr>
        <td><strong>MPN+EE+ED-Phase</strong></td>
        <td>4.20</td><td><strong>12.47</strong></td><td><strong>1.26</strong></td><td><strong>0.85</strong></td><td><strong>3.88 ± 0.09</strong></td>
      </tr>

      <tr><td colspan="6"><em>Context</em></td></tr>
      <tr>
        <td>NoEnh</td>
        <td>−3.34</td><td>6.33</td><td>2.52</td><td>1.78</td><td>2.40 ± 0.12</td>
      </tr>
      <tr>
        <td>Clean (reference)</td>
        <td>—</td><td>—</td><td>—</td><td>—</td><td>4.60 ± 0.07</td>
      </tr>
    </tbody>
  </table>
 

  <footer>
    <p class="small">Project page: <a href="https://parakrant.github.io/muphasenet/" target="_blank" rel="noopener">parakrant.github.io/muphasenet</a></p>
  </footer>
</div>

<script>
/* =======================
   CONFIG — edit as needed
   ======================= */
const EXT = "wav"; // or "mp3" if your files are MP3

// Seven systems total, grouped to match the paper’s Block A/B
const SYSTEMS = [
  // Context
  { key:"noenh",           label:"NoEnh (unprocessed)",     group:"Context" },
  { key:"clean",           label:"Clean (reference)",       group:"Context" },

  // Block A: baseline noise+reverb simulator
  { key:"mpn_baseline",    label:"MPN (noise+reverb)",  group:"Block A" },

  // Block B: proposed effects-aware simulator
  { key:"mpn_effectaware", label:"MPN (effects-aware)", group:"Block B" },
  { key:"mpn_ee",          label:"MPN+EE",              group:"Block B" },
  { key:"mpn_ee_edmag",    label:"MPN+EE+ED-Mag",       group:"Block B" },
  { key:"mpn_ee_edphase",  label:"MPN+EE+ED-Phase",     group:"Block B" }
];

// Five clips (rename labels if you like)
const CLIPS = [
  { id:"clip1", label:"Clip 1" },
  { id:"clip2", label:"Clip 2" },
  { id:"clip3", label:"Clip 3" },
  { id:"clip4", label:"Clip 4" },
  { id:"clip5", label:"Clip 5" }
];

// Footer info
const SHOW_TECH_FOOTER = false; // set to true to show technical details

/* ==============
   Page rendering
   ============== */
const legend = document.getElementById('legend');
const descriptions = {
  "NoEnh (unprocessed)": "unprocessed input that approximates real-world degradations",
  "Clean (reference)": "clean reference audio",
  "MPN (noise+reverb)": "baseline MuPhaseNet model trained with noise+reverb simulator",
  "MPN (effects-aware)": "baseline MuPhaseNet model trained with effects-aware simulator", 
  "MPN+EE": "MPN augmented with EffectEncoder (bounded FiLM conditioning)",
  "MPN+EE+ED-Mag": "MPN+EE with EffectDecoder producing conservative residuals in magnitude branch",
  "MPN+EE+ED-Phase": "MPN+EE with EffectDecoder producing conservative residuals in phase branch"
};

legend.innerHTML = 'Systems:<br>' + SYSTEMS
  .map(s => `<span class="small" style="display:block;margin:0.3rem 0"><strong>${s.label}</strong> - ${descriptions[s.label] || s.label}</span>`)
  .join('');

// Populate metric description
document.getElementById('metric-desc').innerHTML = `
  <span class="small" style="display:block;margin:0.3rem 0">
    <strong>Combined objective and subjective (MOS) metrics on MUSDB18 test set.</strong>
  </span>
  <span class="small" style="display:block;margin:0.3rem 0">
    ↑ higher is better; ↓ lower is better. 
    The table shows results for systems trained with baseline noise+reverb simulator (top section) and the proposed effects-aware simulator (middle section), with context references at the bottom.
  </span>
  <span class="small" style="display:block;margin:0.3rem 0">
    <strong>Metrics:</strong> SDR (Signal-to-Distortion Ratio), fwSSNR (frequency-weighted Segmental SNR), L1 (log-spectrogram ℓ₁ distance), MRS (Multi-Resolution STFT loss), MOS (Mean Opinion Score from 15 listeners, 30 clips, mean ± 95% CI).
  </span>
`;

document.getElementById('footer').textContent = SHOW_TECH_FOOTER ? 
  `Files: ${EXT.toUpperCase()}. Headphones recommended.` : 
  "Headphones recommended for best audio quality.";

const thead = document.getElementById('thead');
const tbody = document.getElementById('tbody');
const players = new Map(); // clipId -> Map(systemKey -> Audio)

function stopAllExcept(keep){
  players.forEach(sysMap => sysMap.forEach(a => { 
    if(a !== keep && !a.paused){ 
      a.pause(); 
      a.currentTime = 0;
    }
  }));
}

// Create table header
const headerRow = document.createElement('tr');
const emptyHeader = document.createElement('th');
emptyHeader.textContent = 'Clip';
headerRow.appendChild(emptyHeader);

SYSTEMS.forEach(system => {
  const th = document.createElement('th');
  th.textContent = system.label.replace(/^\([AB]\)\s*/, ''); // Remove (A)/(B) prefix for cleaner look
  th.style.fontSize = '0.8rem';
  th.style.padding = '0.5rem 0.25rem';
  th.style.textAlign = 'center';
  headerRow.appendChild(th);
});

thead.appendChild(headerRow);

// Create table body with clips as rows
CLIPS.forEach(clip => {
  const tr = document.createElement('tr');
  
  // Clip name cell
  const clipCell = document.createElement('td');
  clipCell.className = 'rowhdr';
  clipCell.textContent = clip.label;
  tr.appendChild(clipCell);
  
  // Initialize audio players for this clip
  if (!players.has(clip.id)) players.set(clip.id, new Map());
  
  // Create audio cell for each system
  SYSTEMS.forEach(system => {
    const cell = document.createElement('td');
    cell.className = 'audio-cell';
    
    const audio = document.createElement('audio');
    audio.controls = true;
    audio.className = 'cell-audio';
    audio.src = `audio/${clip.id}/${system.key}.${EXT}`;
    audio.preload = 'metadata';
    
    // When audio plays, stop all others
    audio.addEventListener('play', () => {
      stopAllExcept(audio);
    });
    
    cell.appendChild(audio);
    tr.appendChild(cell);
    
    // Store audio element
    players.get(clip.id).set(system.key, audio);
  });
  
  tbody.appendChild(tr);
});
</script>
</body>
</html>
